package json.test;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.hb0730.admin.upms.commons.entity.AuthUser;
import org.junit.Test;

/**
 * @author bing_huang
 */
public class JsonTest {

    @Test
    public void searchNode() throws JsonProcessingException {
        String json = "{\"authorities\":[{\"authority\":\"ROLE_USER\",\"attributes\":{\"authorities\":[{\"authority\":\"SCOPE_read\"},{\"authority\":\"SCOPE_write\"},{\"authority\":\"ROLE_ADMIN\"}],\"details\":{\"remoteAddress\":\"127.0.0.1\",\"sessionId\":null},\"authenticated\":true,\"principal\":{\"attributes\":{\"user_name\":\"admin\",\"user-info\":{\"principal\":{\"password\":null,\"credentialsNonExpired\":true,\"nickname\":\"管理员\",\"accountNonExpired\":true,\"userId\":1,\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}],\"enabled\":true,\"username\":\"admin\",\"accountNonLocked\":true},\"authenticated\":true,\"credentials\":null,\"name\":\"admin\",\"details\":{\"sessionId\":\"ec2f5862-6d2d-409b-b64e-5f778a8551f0\",\"remoteAddress\":\"0:0:0:0:0:0:0:1\"},\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}]},\"scope\":[\"read\",\"write\"],\"active\":true,\"exp\":\"2089-01-24T08:26:25Z\",\"authorities\":[\"ROLE_ADMIN\"],\"client_id\":\"upms-server\"},\"authorities\":[{\"authority\":\"SCOPE_read\"},{\"authority\":\"SCOPE_write\"},{\"authority\":\"ROLE_ADMIN\"}],\"name\":\"admin\"},\"credentials\":{\"tokenValue\":\"JQdExV3T92eU0ZJ+lfGFeuKFECs=\",\"issuedAt\":null,\"expiresAt\":\"2089-01-24T08:26:25Z\",\"tokenType\":{\"value\":\"Bearer\"},\"scopes\":[]},\"token\":{\"tokenValue\":\"JQdExV3T92eU0ZJ+lfGFeuKFECs=\",\"issuedAt\":null,\"expiresAt\":\"2089-01-24T08:26:25Z\",\"tokenType\":{\"value\":\"Bearer\"},\"scopes\":[]},\"tokenAttributes\":{\"user_name\":\"admin\",\"user-info\":{\"principal\":{\"password\":null,\"credentialsNonExpired\":true,\"nickname\":\"管理员\",\"accountNonExpired\":true,\"userId\":1,\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}],\"enabled\":true,\"username\":\"admin\",\"accountNonLocked\":true},\"authenticated\":true,\"credentials\":null,\"name\":\"admin\",\"details\":{\"sessionId\":\"ec2f5862-6d2d-409b-b64e-5f778a8551f0\",\"remoteAddress\":\"0:0:0:0:0:0:0:1\"},\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}]},\"scope\":[\"read\",\"write\"],\"active\":true,\"exp\":\"2089-01-24T08:26:25Z\",\"authorities\":[\"ROLE_ADMIN\"],\"client_id\":\"upms-server\"},\"name\":\"admin\"}},{\"authority\":\"SCOPE_read\"},{\"authority\":\"SCOPE_write\"}],\"details\":{\"remoteAddress\":\"0:0:0:0:0:0:0:1\",\"sessionId\":\"621398C69248179A7E5C90F393F30534\"},\"authenticated\":true,\"principal\":{\"authorities\":[{\"authority\":\"ROLE_USER\",\"attributes\":{\"authorities\":[{\"authority\":\"SCOPE_read\"},{\"authority\":\"SCOPE_write\"},{\"authority\":\"ROLE_ADMIN\"}],\"details\":{\"remoteAddress\":\"127.0.0.1\",\"sessionId\":null},\"authenticated\":true,\"principal\":{\"attributes\":{\"user_name\":\"admin\",\"user-info\":{\"principal\":{\"password\":null,\"credentialsNonExpired\":true,\"nickname\":\"管理员\",\"accountNonExpired\":true,\"userId\":1,\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}],\"enabled\":true,\"username\":\"admin\",\"accountNonLocked\":true},\"authenticated\":true,\"credentials\":null,\"name\":\"admin\",\"details\":{\"sessionId\":\"ec2f5862-6d2d-409b-b64e-5f778a8551f0\",\"remoteAddress\":\"0:0:0:0:0:0:0:1\"},\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}]},\"scope\":[\"read\",\"write\"],\"active\":true,\"exp\":\"2089-01-24T08:26:25Z\",\"authorities\":[\"ROLE_ADMIN\"],\"client_id\":\"upms-server\"},\"authorities\":[{\"authority\":\"SCOPE_read\"},{\"authority\":\"SCOPE_write\"},{\"authority\":\"ROLE_ADMIN\"}],\"name\":\"admin\"},\"credentials\":{\"tokenValue\":\"JQdExV3T92eU0ZJ+lfGFeuKFECs=\",\"issuedAt\":null,\"expiresAt\":\"2089-01-24T08:26:25Z\",\"tokenType\":{\"value\":\"Bearer\"},\"scopes\":[]},\"token\":{\"tokenValue\":\"JQdExV3T92eU0ZJ+lfGFeuKFECs=\",\"issuedAt\":null,\"expiresAt\":\"2089-01-24T08:26:25Z\",\"tokenType\":{\"value\":\"Bearer\"},\"scopes\":[]},\"tokenAttributes\":{\"user_name\":\"admin\",\"user-info\":{\"principal\":{\"password\":null,\"credentialsNonExpired\":true,\"nickname\":\"管理员\",\"accountNonExpired\":true,\"userId\":1,\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}],\"enabled\":true,\"username\":\"admin\",\"accountNonLocked\":true},\"authenticated\":true,\"credentials\":null,\"name\":\"admin\",\"details\":{\"sessionId\":\"ec2f5862-6d2d-409b-b64e-5f778a8551f0\",\"remoteAddress\":\"0:0:0:0:0:0:0:1\"},\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}]},\"scope\":[\"read\",\"write\"],\"active\":true,\"exp\":\"2089-01-24T08:26:25Z\",\"authorities\":[\"ROLE_ADMIN\"],\"client_id\":\"upms-server\"},\"name\":\"admin\"}},{\"authority\":\"SCOPE_read\"},{\"authority\":\"SCOPE_write\"}],\"attributes\":{\"authorities\":[{\"authority\":\"SCOPE_read\"},{\"authority\":\"SCOPE_write\"},{\"authority\":\"ROLE_ADMIN\"}],\"details\":{\"remoteAddress\":\"127.0.0.1\",\"sessionId\":null},\"authenticated\":true,\"principal\":{\"attributes\":{\"user_name\":\"admin\",\"user-info\":{\"principal\":{\"password\":null,\"credentialsNonExpired\":true,\"nickname\":\"管理员\",\"accountNonExpired\":true,\"userId\":1,\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}],\"enabled\":true,\"username\":\"admin\",\"accountNonLocked\":true},\"authenticated\":true,\"credentials\":null,\"name\":\"admin\",\"details\":{\"sessionId\":\"ec2f5862-6d2d-409b-b64e-5f778a8551f0\",\"remoteAddress\":\"0:0:0:0:0:0:0:1\"},\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}]},\"scope\":[\"read\",\"write\"],\"active\":true,\"exp\":\"2089-01-24T08:26:25Z\",\"authorities\":[\"ROLE_ADMIN\"],\"client_id\":\"upms-server\"},\"authorities\":[{\"authority\":\"SCOPE_read\"},{\"authority\":\"SCOPE_write\"},{\"authority\":\"ROLE_ADMIN\"}],\"name\":\"admin\"},\"credentials\":{\"tokenValue\":\"JQdExV3T92eU0ZJ+lfGFeuKFECs=\",\"issuedAt\":null,\"expiresAt\":\"2089-01-24T08:26:25Z\",\"tokenType\":{\"value\":\"Bearer\"},\"scopes\":[]},\"token\":{\"tokenValue\":\"JQdExV3T92eU0ZJ+lfGFeuKFECs=\",\"issuedAt\":null,\"expiresAt\":\"2089-01-24T08:26:25Z\",\"tokenType\":{\"value\":\"Bearer\"},\"scopes\":[]},\"tokenAttributes\":{\"user_name\":\"admin\",\"user-info\":{\"principal\":{\"password\":null,\"credentialsNonExpired\":true,\"nickname\":\"管理员\",\"accountNonExpired\":true,\"userId\":1,\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}],\"enabled\":true,\"username\":\"admin\",\"accountNonLocked\":true},\"authenticated\":true,\"credentials\":null,\"name\":\"admin\",\"details\":{\"sessionId\":\"ec2f5862-6d2d-409b-b64e-5f778a8551f0\",\"remoteAddress\":\"0:0:0:0:0:0:0:1\"},\"authorities\":[{\"authority\":\"ROLE_ADMIN\"}]},\"scope\":[\"read\",\"write\"],\"active\":true,\"exp\":\"2089-01-24T08:26:25Z\",\"authorities\":[\"ROLE_ADMIN\"],\"client_id\":\"upms-server\"},\"name\":\"admin\"},\"name\":\"admin\"},\"authorizedClientRegistrationId\":\"upms-login\",\"credentials\":\"\",\"name\":\"admin\"}";
        ObjectMapper mapper = new ObjectMapper();
        JsonNode jsonNode = mapper.readTree(json);
        JsonNode nodeValue = jsonNode.findValue("user-info");
        String value = nodeValue.toString();
        AuthUser authentication = mapper.readValue(value, AuthUser.class);

    }
}
